import sys
sys.path.append('..')
import gc
gc.enable()

from utils import get_logger, get_arguments, load_features, load_target
from models import train_rf


# load test data
x_train_all, _ = load_features(features, _debug, target='test')

# to store results
y_preds = np.zeros(x_test.shape[0])

# predict
y_pred = model.predict(x_test)

y_preds += y_pred / n_splits

# create submission file
sub_df = pd.read_pickle('../../data/input/sample_submission.pkl')
if _debug:
    sub_df = sub_df.iloc[:int(sub_df.shape[0] / 100)]
sub_df[label_name] = y_preds
logger.debug('sub_df:{0}'.format(sub_df.shape))

# save
sub_df.to_csv(
    '../../data/output/sub_{0:%m%d_%H%M%S}_{1:.5f}_{2}.csv'.format(
        start_dt, scores_cv_te['auc'], model_name),
    index=False
)


