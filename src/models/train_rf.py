from sklearn.ensemble import RandomForestClassifier


def train_rf(x_tr, y_tr, x_te, x_test, rf_params):
    """
    train model with given tr_idx data and return prediction on te_idx data
    """
    model = RandomForestClassifier(**rf_params)  # define model
    model.fit(x_tr, y_tr)  # train model

    y_tr_pr = model.predict(x_tr)  # predict train
    y_te_pr = model.predict(x_te)  # predict test
    y_pred = model.predict(x_test)

    return y_tr_pr, y_te_pr, y_pred, model
